<!doctype html>
<html class="../../../../no-js" lang="en">

<head th:replace="~{Layout/layout :: head}">

</head>

<body class="materialdesign">
    <style>
        /* Asegúrate de que el modal tenga un z-index mayor que el fondo */
        .modal-backdrop {
            z-index: 1040 !important;
        }

        .modal {
            z-index: 1050 !important;
        }

        .modal-xl-custom {
            width: 100%;
            /* Ajusta el tamaño del modal al 80% del ancho de la ventana */
            max-width: 1700px;
            /* Puedes definir un ancho máximo */
        }

        .modal-lg-custom {
            width: 80%;
            /* Ajusta el tamaño del modal al 80% del ancho de la ventana */
            max-width: 1200px;
            /* Puedes definir un ancho máximo */
        }

        .modal-sm-custom {
            width: 50%;
            /* Ajusta el tamaño del modal al 50% del ancho de la ventana */
            max-width: 800px;
            /* Establece un máximo de 800px */
        }
    </style>

    <!-- Header top area start-->
    <div class="wrapper-pro">
        <div th:replace="~{Layout/layout :: preloader}"></div>
        <div th:replace="~{Layout/layout :: left_sidebar}" class="left-sidebar-pro">
        </div>
        <!-- Header top area start-->
        <div class="content-inner-all">
            <div th:replace="~{Layout/layout :: header}" class="header-top-area">
            </div>
            <!-- Header top area end-->
            <!-- Breadcome start-->
            <div class="breadcome-area mg-b-30 small-dn">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="breadcome-list map-mg-t-40-gl shadow-reset">
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="breadcome-heading">
                                            <form role="search" class="">
                                                <input type="text" placeholder="Search..." class="form-control">
                                                <a href=""><i class="fa fa-search"></i></a>
                                            </form>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <ul class="breadcome-menu">
                                            <li><a href="#">INICIO</a> <span class="bread-slash">/</span>
                                            </li>
                                            <li><span class="bread-blod">ACTA</span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Breadcome End-->
            <!-- Mobile Menu start -->
            <div th:replace="~{Layout/layout :: mobile}" class="mobile-menu-area">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="mobile-menu">
                                <nav id="dropdown">
                                    <ul class="mobile-menu-nav">
                                        <li><a data-toggle="collapse" data-target="#Charts" href="#">Home <span
                                                    class="admin-project-icon adminpro-icon adminpro-down-arrow"></span></a>
                                            <ul class="collapse dropdown-header-top">
                                                <li><a href="dashboard.html">Dashboard v.</a>
                                                </li>
                                                <li><a href="dashboard-2.html">Dashboard v.2</a>
                                                </li>
                                                <li><a href="analytics.html">Analytics</a>
                                                </li>
                                                <li><a href="widgets.html">Widgets</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a data-toggle="collapse" data-target="#demo" href="#">Mailbox <span
                                                    class="admin-project-icon adminpro-icon adminpro-down-arrow"></span></a>
                                            <ul id="demo" class="collapse dropdown-header-top">
                                                <li><a href="inbox.html">Inbox</a>
                                                </li>
                                                <li><a href="view-mail.html">View Mail</a>
                                                </li>
                                                <li><a href="compose-mail.html">Compose Mail</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a data-toggle="collapse" data-target="#others" href="#">Miscellaneous <span
                                                    class="admin-project-icon adminpro-icon adminpro-down-arrow"></span></a>
                                            <ul id="others" class="collapse dropdown-header-top">
                                                <li><a href="profile.html">Profile</a>
                                                </li>
                                                <li><a href="contact-client.html">Contact Client</a>
                                                </li>
                                                <li><a href="contact-client-v.1.html">Contact Client v.1</a>
                                                </li>
                                                <li><a href="project-list.html">Project List</a>
                                                </li>
                                                <li><a href="project-details.html">Project Details</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a data-toggle="collapse" data-target="#Miscellaneousmob" href="#">Interface
                                                <span
                                                    class="admin-project-icon adminpro-icon adminpro-down-arrow"></span></a>
                                            <ul id="Miscellaneousmob" class="collapse dropdown-header-top">
                                                <li><a href="google-map.html">Google Map</a>
                                                </li>
                                                <li><a href="data-maps.html">Data Maps</a>
                                                </li>
                                                <li><a href="pdf-viewer.html">Pdf Viewer</a>
                                                </li>
                                                <li><a href="x-editable.html">X-Editable</a>
                                                </li>
                                                <li><a href="code-editor.html">Code Editor</a>
                                                </li>
                                                <li><a href="tree-view.html">Tree View</a>
                                                </li>
                                                <li><a href="preloader.html">Preloader</a>
                                                </li>
                                                <li><a href="images-cropper.html">Images Cropper</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a data-toggle="collapse" data-target="#Chartsmob" href="#">Charts <span
                                                    class="admin-project-icon adminpro-icon adminpro-down-arrow"></span></a>
                                            <ul id="Chartsmob" class="collapse dropdown-header-top">
                                                <li><a href="bar-charts.html">Bar Charts</a>
                                                </li>
                                                <li><a href="line-charts.html">Line Charts</a>
                                                </li>
                                                <li><a href="area-charts.html">Area Charts</a>
                                                </li>
                                                <li><a href="rounded-chart.html">Rounded Charts</a>
                                                </li>
                                                <li><a href="c3.html">C3 Charts</a>
                                                </li>
                                                <li><a href="sparkline.html">Sparkline Charts</a>
                                                </li>
                                                <li><a href="peity.html">Peity Charts</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a data-toggle="collapse" data-target="#Tablesmob" href="#">Tables <span
                                                    class="admin-project-icon adminpro-icon adminpro-down-arrow"></span></a>
                                            <ul id="Tablesmob" class="collapse dropdown-header-top">
                                                <li><a href="static-table.html">Static Table</a>
                                                </li>
                                                <li><a href="data-table.html">Data Table</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a data-toggle="collapse" data-target="#formsmob" href="#">Forms <span
                                                    class="admin-project-icon adminpro-icon adminpro-down-arrow"></span></a>
                                            <ul id="formsmob" class="collapse dropdown-header-top">
                                                <li><a href="basic-form-element.html">Basic Form Elements</a>
                                                </li>
                                                <li><a href="advance-form-element.html">Advanced Form Elements</a>
                                                </li>
                                                <li><a href="password-meter.html">Password Meter</a>
                                                </li>
                                                <li><a href="multi-upload.html">Multi Upload</a>
                                                </li>
                                                <li><a href="tinymc.html">Text Editor</a>
                                                </li>
                                                <li><a href="dual-list-box.html">Dual List Box</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a data-toggle="collapse" data-target="#Appviewsmob" href="#">App views
                                                <span
                                                    class="admin-project-icon adminpro-icon adminpro-down-arrow"></span></a>
                                            <ul id="Appviewsmob" class="collapse dropdown-header-top">
                                                <li><a href="basic-form-element.html">Basic Form Elements</a>
                                                </li>
                                                <li><a href="advance-form-element.html">Advanced Form Elements</a>
                                                </li>
                                                <li><a href="password-meter.html">Password Meter</a>
                                                </li>
                                                <li><a href="multi-upload.html">Multi Upload</a>
                                                </li>
                                                <li><a href="tinymc.html">Text Editor</a>
                                                </li>
                                                <li><a href="dual-list-box.html">Dual List Box</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a data-toggle="collapse" data-target="#Pagemob" href="#">Pages <span
                                                    class="admin-project-icon adminpro-icon adminpro-down-arrow"></span></a>
                                            <ul id="Pagemob" class="collapse dropdown-header-top">
                                                <li><a href="login.html">Login</a>
                                                </li>
                                                <li><a href="register.html">Register</a>
                                                </li>
                                                <li><a href="captcha.html">Captcha</a>
                                                </li>
                                                <li><a href="checkout.html">Checkout</a>
                                                </li>
                                                <li><a href="contact.html">Contacts</a>
                                                </li>
                                                <li><a href="review.html">Review</a>
                                                </li>
                                                <li><a href="order.html">Order</a>
                                                </li>
                                                <li><a href="comment.html">Comment</a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Mobile Menu end -->
            <!-- Breadcome start-->
            <div class="breadcome-area des-none mg-b-30">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="breadcome-list map-mg-t-40-gl shadow-reset">
                                <div class="row">
                                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                        <div class="breadcome-heading">
                                            <form role="search" class="">
                                                <input type="text" placeholder="Search..." class="form-control">
                                                <a href=""><i class="fa fa-search"></i></a>
                                            </form>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                        <ul class="breadcome-menu">
                                            <li><a href="#">INICIO</a> <span class="bread-slash">/</span>
                                            </li>
                                            <li><span class="bread-blod">PERSONA</span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Breadcome End-->
            <!-- Register Start-->
            <div class="login-form-area mg-t-30 mg-b-15">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-3"></div>
                        <form th:action="${edit}? @{/acta/modificar}: @{/acta/registrar}" method="post"
                            id="miFormulario" class="adminpro-form" enctype="multipart/form-data">
                            <input type="hidden" th:field="${acta.id_acta}" th:if="${edit != null}">
                            <div class="col-lg-6">
                                <div class="login-bg">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div th:replace="~{Layout/layout :: alert}"></div>
                                            <div class="logo">
                                                <a href="#"><img src="../../../../img/logo/UAP_DIGITAL_NORMAL.webp"
                                                        alt="" width="300" height="200" />
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row" style="text-align: center;">
                                        <div class="col-lg-6">
                                            <div class="login-title">
                                                <h1>Registrar Acta </h1>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="login-title">
                                                <div th:class="'alert alert-'+${tipoMensaje}" th:if="${mensaje != null}">
                                                    <button type="button" class="close" data-dismiss="alert"
                                                        aria-hidden="true">&times;</button>
                                                    <strong th:text="${mensaje}"></strong>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-4">
                                            <div class="login-input-head">
                                                <p>Mesa </p>
                                            </div>
                                        </div>
                                        <div class="col-lg-8">
                                            <select name="mesa" style="width: 100%" class="select2 form-control"
                                                th:field="${acta.mesa}" required>
                                                <option th:each="mesa : ${mesas}" th:value="${mesa.id_mesa}"
                                                    th:text="${mesa.nombre_mesa}"></option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-4">
                                            <div class="login-input-head">
                                                <p>Adjunto</p>
                                            </div>
                                        </div>
                                        <div class="col-lg-8">
                                            <input type="file" class="form-control form-control-file" name="file"
                                                id="file" accept=".pdf, application/pdf">
                                            <div id="alertaImgC"></div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-8 d-flex justify-content-between">
                                            <div class="login-button-pro">
                                                <button type="submit" class="btn btn-primary"
                                                    th:text="${edit}? 'Guardar Cambios': 'Registrar'"></button>
                                            </div>
                                            <a class="btn btn-secondary" th:href="@{'/acta/ventana'}" th:if="${edit}">Cancelar</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="content">
                <div class="container-fluid">
                    <div class="row col-md-12">
                        <div class="table-responsive">
                            <div class="sparkline13-graph">
                                <div class="datatable-dashv1-list custom-datatable-overright">
                                    <div id="toolbar">
                                        <select class="form-control">
                                            <option value="">Export Basic</option>
                                            <option value="all">Export All</option>
                                            <option value="selected">Export Selected</option>
                                        </select>
                                    </div>
                                    <table id="table" data-toggle="table" data-pagination="true" data-search="true"
                                        data-show-columns="true" data-show-pagination-switch="true"
                                        data-show-refresh="true" data-key-events="true" data-show-toggle="true"
                                        data-resizable="true" data-cookie="true" data-cookie-id-table="saveId"
                                        data-show-export="true" data-click-to-select="true" data-toolbar="#toolbar">
                                        <thead>
                                            <tr>
                                                <th data-field="id">#</th>
                                                <th data-field="name">Mesa</th>
                                                <th data-field="action">Accion</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr th:each="a, num : ${actas}" th:if="${a.estado != 'X'}">
                                                <td th:text="${num.count}"></td>
                                                <td th:text="${a.mesa.nombre_mesa}"></td>
                                                <td style="text-align: center;">
                                                    <!-- <a type="button" style="color: white;"
                                                        class="btn btn-custon-rounded-three btn-primary"
                                                        data-toggle="modal" data-target="#modalAdjunto"> Ver
                                                        Adjunto</a> -->
                                                    <a type="button" style="color: white;"
                                                        class="btn btn-custon-rounded-three btn-primary"
                                                        data-toggle="modal" data-target="#modalAdjunto"
                                                        th:onclick="verAdjunto([[${a.rutaArchivo}]], [[${a.tipoArchivo}]])">
                                                        Ver
                                                        Adjunto</a>
                                                    <a type="button" style="color: white;"
                                                        th:href="${'/acta/ventanaEdit/'+a.id_acta}"
                                                        class="btn btn-custon-rounded-three btn-success"> Editar</a>
                                                    <a type="button" style="color: white;"
                                                        th:href="${'/acta/eliminar/'+a.id_acta}"
                                                        class="btn btn-custon-rounded-three btn-danger"> Eliminar</a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="modalAdjunto" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-xl-custom">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">Adjunto</h4>
                </div>

                <!-- Modal Body -->
                <div class="modal-body">
                    <div class="container" id="contenidoModal">

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Start-->
    <div th:replace="~{Layout/layout :: footer}" class="footer-copyright-area">
    </div>
    <!-- Footer End-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.getElementById("miFormulario").addEventListener("submit", function (event) {
            event.preventDefault(); // Evitar que el formulario se envíe automáticamente

            Swal.fire({
                title: "¿Estás seguro?",
                text: "Una vez enviado, no podrás deshacer esta acción.",
                icon: "warning",
                showCancelButton: true, // Mostrar el botón de cancelar
                confirmButtonText: "Sí, enviar",
                cancelButtonText: "Cancelar", // Texto del botón de cancelar
                buttonsStyling: false, // Desactivar estilos automáticos para personalizar los botones


            })
                .then((result) => {
                    if (result.isConfirmed) {
                        // Si el usuario confirma, envía el formulario
                        document.getElementById("miFormulario").submit();
                    } else if (result.dismiss === Swal.DismissReason.cancel) {
                        // Si el usuario cancela, no se hace nada
                        Swal.fire("La acción ha sido cancelada.", {
                            icon: "info",
                        });
                    }
                });
        });
    </script>

    <div th:replace="~{Layout/layout :: scripts}"></div>
    <!-- <script th:if="${edit == null}">
        $('.select2').empty();
    </script> -->
    <script>
        

        $(".select2").select2({
            placeholder: "Seleccione Nro de Mesa...",
            allowClear: true
        });

        const inputElement = document.getElementById('file');

        inputElement.addEventListener('change', (event) => {
            const file = event.target.files[0];  // Obtener el primer (y único) archivo seleccionado
            const fileType = file ? file.type : null;  // Verificar el tipo del archivo

            // Comprobar si el archivo es un PDF
            if (file && fileType !== 'application/pdf') {
                // Si el archivo no es PDF, limpiamos el campo de entrada
                inputElement.value = '';  // Limpiar el campo de selección de archivo

                // Mostrar un mensaje de error
                $('#alertaImgC').html('<div class="alert alert-danger alert-dismissible">' +
                    '<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>' +
                    'Solo se admite un archivo PDF' +
                    '</div>');
            } else {
                // Si el archivo es PDF, puedes continuar con cualquier otra lógica que necesites
                // (este bloque es opcional, dependiendo de lo que quieras hacer con los archivos válidos)
            }
        });

        function verAdjunto(archivo, tipo) {
            $('#contenidoModal').html(`<embed src="/uploads/${archivo}" type="${tipo}" width="800" height="650">`);
        }
    </script>
</body>

</html>